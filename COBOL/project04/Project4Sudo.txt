//INPUT VARIABLES							NICK HOUSER
STRING I-GUEST, I-CONDO, I-PETS, I-HOTTUB
INTEGER I-BEDROOMS, I-NIGHTS, I-DATE
DOUBLE I-DOCKSLIP

//CALCULATED VARIABLES
STRING EOF = "FALSE" PRICEFLAG = '****', I-MM
DOUBLE C-CLEANFEE, C-PETDEAL, C-HTUBDEAL, C-TOTALDEAL=0
	C-NIGHTFEE, C-CONDOFEE, C-SUBTOTAL, C-PAGECTR = 0, C-TOTALDUE, C-DOCKFEE

//TOTALS VARIABLES
DOUBLE GT-SUBTOTAL =0, GT-TOTALDEAL=0, GT-TOTALDUE=0, GT-RENTALCTR=0, GT-FREENIGHTS=0, 
	GT-FREECLEAN=0, GT-PETFEE=0, GT-HTUBFEE=0

//OUTPUT VARIABLES
STRING O-CONDO, O-NIGHTS, O-NIGHTFEE, O-CONDOFEE, O-CLEANFEE, O-DOCKFEE,
	O-SUBTOTAL, O-DATE, O-TOTALDEAL, O-TOTALDUE, O-GT-RENTALCTR,
	O-GT-FREENIGHTS, O-GT-FREECLEAN, O-GT-PETFEE, O-PAGECTR, O-MONTH,
	O-GT-SUBTOTAL, O-GT-TOTALDEAL, O-GT-TOTALDUE, O-GT-HTUBFEE

MAIN
	1000-INIT
	WHILE EOF == 'FALSE'
		CALL 2000-MAINLINE
	END-WHILE
	3000-CLOSING

1000-INIT
	OPEN INPUT FILE
	OPEN OUTPUT FILE
	O-DATE = FORMAT(SYSDATE)
	I-MM = FORMAT(SYSDATE MONTH)
	CALL 1100-GET-MONTH
	CALL 9900-HEADINGS
	CALL 9000-READ

1100-GET-MONTH
	EVALUATE I-MM
		WHEN 01
			MOVE 'JANUARY' TO O-MONTH
		WHEN 02
			MOVE 'FEBURARY' TO O-MONTH
		WHEN 03
			MOVE 'MARCH' TO O-MONTH
		WHEN 04
			MOVE 'APRIL' TO O-MONTH
		WHEN 05
			MOVE 'MAY' TO O-MONTH
		WHEN 06
			MOVE 'JUNE' TO O-MONTH
		WHEN 07
			MOVE 'JULY' TO O-MONTH
		WHEN 08
			MOVE 'AUGUST' TO O-MONTH
		WHEN 09
			MOVE 'SEPTEMBER' TO O-MONTH
		WHEN 10
			MOVE 'OCTOBER' TO O-MONTH
		WHEN 11
			MOVE 'NOVEMBER' TO O-MONTH
		WHEN 12
			MOVE 'DECEMBER' TO O-MONTH.
		

2000-MAINLINE
	CALL 2100-CALCS
	CALL 2200-OUTPUT
	CALL 9000-READ

2100-CALCS
	PRICEFLAG = "    "  		//CLEAR CALC VARIABLES
	C-TOTALDEAL = 0
	C-PETDEAL = 0
	C-HTUBDEAL = 0
	EVALUATE I-CONDO
		WHEN 'HB'
			O-CONDO = "HORSESHOE BEND"
			C-NIGHTFEE = ROUND(I-BEDROOMS * 99.5)
			C-CONDOFEE = ROUND(C-NIGHTFEE * I-NIGHTS)
			C-CLEANFEE = 100
			EVALUATE I-PETS
				WHEN 'Y'
					C-PETDEAL += ROUND(C-CONDOFEE * .1)
					C-TOTALDEAL += C-PETDEAL
			END-EVALUATE
			EVALUATE I-HOTTUB
				WHEN 'Y'
					C-HTUBDEAL += ROUND(C-CONDOFEE * .05)
					C-TOTALDEAL += C-HTUBDEAL
			END-EVALUATE
		WHEN 'OB'
			O-CONDO = "OSAGE BEACH"
			C-NIGHTFEE = ROUND(I-BEDROOMS * 188)
			C-CONDOFEE = ROUND(C-NIGHTFEE * I-NIGHTS)
			C-CLEANFEE = 150
			EVALUATE I-PETS
				WHEN 'Y'
					C-PETDEAL += ROUND(C-CONDOFEE * .1)
					C-TOTALDEAL += C-PETDEAL
			END-EVALUATE
			EVALUATE I-NIGHTS
				WHEN > 6
					C-TOTALDEAL -= C-NIGHTFEE
					GT-FREENIGHTS += 1
			END-EVALUATE
		WHEN 'PP'
			O-CONDO = "PISTOL POINT"
			C-NIGHTFEE = ROUND(I-BEDROOMS * 50)
			C-CONDOFEE = ROUND(C-NIGHTFEE * I-NIGHTS)
			C-CLEANFEE = 75
			
		WHEN 'RB'
			O-CONDO = "REGATTA BAY"
			C-NIGHTFEE = ROUND(I-BEDROOMS * 62.10)
			C-CONDOFEE = ROUND(C-NIGHTFEE * I-NIGHTS)
			C-CLEANFEE = 75
			EVALUATE I-NIGHTS
				WHEN > 5
					C-TOTALDEAL -= 75
					GT-FREECLEAN += 1
			END-EVALUATE
		WHEN 'SB'
			O-CONDO = "SHAWNEE BEND"
			C-NIGHTFEE = ROUND(I-BEDROOMS * 100)
			C-CONDOFEE = ROUND(C-NIGHTFEE * I-NIGHTS)
			C-CLEANFEE = 150
			EVALUATE I-PETS
				WHEN 'Y'
					C-PETDEAL += ROUND(C-CONDOFEE * .1)
					C-TOTALDEAL += C-PETDEAL
			END-EVALUATE
		WHEN 'L '
			O-CONDO = "LEDGES"
			C-NIGHTFEE = ROUND(I-BEDROOMS * 76.35)
			C-CONDOFEE = ROUND(C-NIGHTFEE * I-NIGHTS)
			C-CLEANFEE = 0
			EVALUATE I-HOTTUB
				WHEN 'Y'
					C-HTUBDEAL += ROUND(C-CONDOFEE * .075)
					C-TOTALDEAL += C-HTUBDEAL
			END-EVALUATE
		WHEN 'HT'
			O-CONDO = "HARBOUR TOWNE"
			C-NIGHTFEE = ROUND(I-BEDROOMS * 50)
			C-CONDOFEE = ROUND(C-NIGHTFEE * I-NIGHTS)
			C-CLEANFEE = 100
			EVALUATE I-NIGHTS
				WHEN > 2
					C-TOTALDEAL -= ROUND(C-NIGHTFEE / 2)
					GT-FREENIGHTS += .5
			END-EVALUATE
		WHEN 'CP'
			O-CONDO = "COMPASSE POINTE"
			C-NIGHTFEE = ROUND(I-BEDROOMS * 125)
			C-CONDOFEE = ROUND(C-NIGHTFEE * I-NIGHTS)
			C-CLEANFEE = 0
			EVALUATE I-NIGHTS
				WHEN > 4
					C-TOTALDEAL -= C-NIGHTFEE
					GT-FREENIGHTS += 1
			END-EVALUATE
	END-EVALUATE
	C-DOCKFEE = ROUND(I-NIGHTS * I-DOCKSLIP)
	C-SUBTOTAL = ROUND(C-CONDOFEE + C-CLEANFEE + C-DOCKFEE)
	C-TOTALDUE = ROUND(C=SUBTOTAL + C=TOTALDEAL)
	//GT CALCS
	GT-SUBTOTAL += C-SUBTOTAL
	GT-TOTALDEAL += C=TOTALDEAL
	GT-TOTALDUE += C=TOTALDUE
	GT-RENTALCTR ++
	GT-PETFEE += C=PETDEAL
	GT-HTUBFEE += C-HTUBDEAL

2200-OUTPUT
	O-NIGHTFEE = FORMAT(C-NIGHTFEE)
	O-CONDOFEE = FORMAT(C-CONDOFEE)
	O-CLEANFEE = FORMAT(C-CLEANFEE)
	O-DOCKFEE = FORMAT(C-DOCKFEE)
	O-SUBTOTAL = FORMAT(C-SUBTOTAL)
	O-TOTALDEAL = FORMAT(C-TOTALDEAL)
	O-TOTALDUE = FORMAT(TOTALDUE)
	IF C-TOTALDUE > 750
		PRICEFLAG = "****"
	PRINT DETAIL LINE: O-CONDO, I-GUEST, I-NIGHTS, O-NIGHTFEE, O-CONDOFEE,
		O-CLEANFEE, O-DOCKFEE, O-SUBTOTAL, O-TOTALDEAL, O-TOTALDEAL, PRICEFLAG
	IF EOP
		CALL 9900-HEADINGS

3000-CLOSING
	CALL 3100-GRAND-TOTALS
	CLOSE INPUT FILE
	CLOSE OUTPUT FILE

3100-GRAND-TOTALS
	O-GT-SUBTOTAL = FORMAT(GT-SUBTOTAL)
	O-GT-TOTALDEAL = FORMAT(GT-TOTALDEAL)
	O-GT-TOTALDUE = FORMAT(GT-TOTALDUE)
	O-GT-RENTALCTR = FORMAT(RENTALCTR)
	O-GT-FREENIGHTS = FORMAT(GT-FREENIGHTS)
	O-GT-FREECLEAN = FORMAT(GT-FREECLEAN)
	O-GT-PETFEE = FORMAT(GT-PETFEE)
	O-GT-HTUBFEE = FORMAT(GT-HTUBFEE)
	PRINT BLANK LINE
	PRINT BLANK LINE
	PRINT TOTALS LINE 1: O-GT-SUBTOTAL, O-GT-TOTALDEAL, O-GT-TOTALDUE
	PRINT BLANK LINE
	PRINT TOTALS LINE 2: O-GT-RENTALCTR, O-GT-FREENIGHTS, O-GT-FREECLEAN
	PRINT TOTALS LINE 3: O-GT-PETFEE, O-GT-HTUBFEE
	
9000-READ
	READ RECORD:I-GUEST, I-CONDO, I-BEDROOMS, I-NIGHTS, I-PETS,
		I-HOTTUB, I-DOCKSLIP
	IF NO MORE RECORDS
		EOF = "TRUE"

9900-HEADINGS
	C-PAGECTR ++
	O-PAGECTR = FORMAT(C-PAGECTR)
	O-DATE = FORMAT(I-DATE)
	PRINT COMPANY TITLE LINE:O-DATE, O-PAGECTR
	PRINT REPORT TITLE LINE: O-MONTH
	PRINT BLANK LINE
	PRINT COLUMN HEADING LINE 1
	PRINT COLUMN HEADING LINE 2
	PRINT BLANK LINE