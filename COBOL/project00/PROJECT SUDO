Variables 

STRING I-REC, I-LNAME, I-FNAME, H-LNAME, H-FNAME, EOF = 'FALSE', DATE,
	O-FNAME, O-LNAME, O-TIME, M-O-AVGTIME
INTEGER I-TIME, M-AVGTIME = 0, M-GAMES = 0, GT-GAMES = 0, GT-AVGTIME = 0, PCTR = 0


MAIN
	INIT
	WHILE EOF == 'FALSE'
		CALL MAINLINE
	END-WHILE
	CALL CLOSING
END-MAIN


INIT
	DATE = FORMAT(SYSDATE)
	OPEN INPUT FILE
	OPEN OUTPUT FILE
	CALL READ
	H-LNAME = I-LNAME
	H-FNAME = I-FNAME
	CALL HEADINGS
END INIT


READ
	READ RECORD: I-REC, I-LNAME, I-FNAME, I-TIME
	IF(NO MORE RECORDS)
		EOF = 'TRUE'
END READ
		
HEADINGS
	PCTR += 1
	PRINT COMPANY TITLE LINE: DATE, PCTR
	PRINT BLANK LINE
	PRINT COLUMN HEADING LINE
	PRINT BLANK LINE
END-HEADINGS

MAINLINE
	IF (H-LNAME != I-LNAME) OR (H-FNAME != I-FNAME)
		CALL MAJOR-ST
	END-IF
	CALL CALCS
	CALL OUTPUT
	CALL READ
END-MAINLINE

CALCS
	M-GAMES += 1
	M-AVGTIME += I-TIME
END-CALCS

OUTPUT
	O-FNAME =FORMAT(I-FNAME)
	O-LNAME= FORMAT(I-FNAME)
	O-TIME = FORMAT(I-TIME)
	PRINT DETAIL LINE: O-FNAME, O-LNAME, O-TIME
END-OUTPUT
	
MAJOR-ST
	GT-AVGTIME += M-AVGTIME
	GT-GAMES += M-GAMES
	
	M-AVGTIME = M-AVGTIME / M-GAMES
	M-O-AVGTIME = FORMAT(M-AVGTIME)
	PRINT BLANK LINE
	PRINT MAJOR LINE: H-LNAME, H-FNAME, M-GAMES, M-O-AVGTIME
	PRINT BLANK LINE
	
	M-AVGTIME = 0
	M-GAMES = 0	
	H-FNAME = I-FNAME
	H-LNAME = I-LNAME
END-MAJOR-ST
	
CLOSING
	CALL GRAND-TOTALS
	CLOSE INPUT FILE
	CLOSE OUTPUT FILE
END-CLOSING

GRAND-TOTALS
	CALL MAJOR-ST
	GT-AVGTIME = GT-AVGTIME / GT-GAMES
	PRINT BLANK LINE
	PRINT GT-LINE: GT-GAMES, GT-AVGTIME
END-GRAND-TOTALS



