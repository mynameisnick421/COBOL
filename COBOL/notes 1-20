Validation

01 I-REC.
	05 	I-CITY		PIC	X(10).	-REQUIRED
		COMPARE AGAINST SPACES IN AN IF STATEMENT
	O5	I-STATUS	PIC X.		- A-I-X
		88 VAL-STATUS			VALUE 'A' 'T 'X'
	05	I-AGE		PIC 999.	- 18-100
		88 VAL-AGE				VALUE 18 THRU 100
	05	I-CAT		PIC 99.		- 10,20,80,95
		88 VAL-CAT				VALUE 10 20 80 95
	05	I-CODE		PIC X.		- A,B,D,E,F,G,H
		88 VAL-CODE				VALUE 'A' 'B' 'D' THRU 'H'
									'O' THRU 'Q'
	
	
	COMPARE TO 
		SPACES
		NUMERIC	0-9 NO DECIMALS
		ALPHABETIC A-Z AND SPACES
		88(CONDITION NAMES) ONLY ELEMENTARY ITEMS NOT GROUP ITEMS
		
		
MAIN
	INIT
	MAINLINE
	
2000-MAINLINE
	PERFORM VALIDATION THRU 2100-X.
	IF ERROR-SWITCH == 'NO'
		PERFORM CALCS
		PERFORM OUTPUT
	ELSE
		PERFORM ERROR ROUTINE.
	PERFORM READ.
	
	
2100-VALIDATION
	MOVE 'YES' TO ERROR-SWITCH.
	IF I-CITY = " "
		MOVE "CITY REQUIRED" TO O-ERROR
		GO TO 2100-X.
	IF NOT VAL-STATUS
		STATUS MUSY BE 'A','I' OR 'X' TO O-ERROR
		GO TO 2100-X.
	IF I-AGE NOT NUMERIC
		MOVE 'AGE MUST BE NUMERIC' TO O-ERROR
		GO TO 2100-X.
	IF NOT VAL-AGE
		MOVE 'AGE MUST BE BLA BLA' TO O-ERROR
		GO TO 2100-X.
	IF I-CAT NOT NUMERIC
		MOVE "BLA BLA" TO O-ERROR
		GO TO 2100-X.
	IF NOT VAL-CAT
		MOVE "ERROR MESSAGE" TO O-ERROR
		GO TO 2100-X.
	IF NOT VAL-CODE
		MOVE "MESSAGE" TO O-ERROR
		GO TO 2100-X.
	MOVE "NO" TO ERROR-SWITCH.
	
2100 X. 
	EXIT.
	
	
ERROR-ROUTINE.
	MOVE I-REC TO O-REC.
	WRITE ERRLINE FROM ERRORLINE
		AFTER ADVANCING 1 LINE
			AT EOP
				PERFORM 9200-ERR-HEADINGS
				ADD 1 TO ERR-CTR.
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
