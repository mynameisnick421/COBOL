//INPUT VARIABLES
STRING I-REC, I-LAST-NAME, I-STATE, I-BOAT-TYPE
INTEGER I-PURCHASE-DATE, I-ACCESSORY-PACKAGE
DOUBLE I-BOAT-COST, I-PREP-DELIVER-COST

//CALC VARIABLES
STRING O-BOAT-TYPE, O-ACCESSORY-PACKAGE, H-BOAT-TYPE-CHAR, EOF = 'FALSE'
INTEGER M-NUM-SOLD = 0, GT-NUM-SOLD = 0, PCTR = 0
DOUBLE C-TOTAL-COST, M-TOTAL-COST= 0, GT-TOTAL-COST= 0

//OUTPUT VARIABLES
STRING O-LAST-NAME, O-STATE, O-BOAT-COST, O-PURCHASE-DATE, O-ACCESSORY-PACKAGE,
	O-PREP-DELIVER-COST, O-TOTAL-COST, O-BOAT-TYPE, O-SYSDATE, O-PCTR, O-M-NUM-SOLD,
	O-M-TOTAL-COST, O-GT-NUM-SOLD, O-GT-TOTAL-COST
	

0000-MAIN
	INIT
	WHILE EOF == 'FALSE'
		CALL MAINLINE
	END-WHILE
	CLOSING



1000-INIT
	OPEN INPUT FILE
	OPEN OUTPUT FILE
	O-SYSDATE = FORMAT(SYSDATE)
	CALL READ
	H-BOAT-TYPE-CHAR = I-BOAT-TYPE
	CALL BOAT-SWITCH
	CALL HEADINGS

2000-MAINLINE
	IF H-BOAT-TYPE-CHAR != I-BOAT-TYPE
		CALL MAJOR-MODULE
	END-IF
	CALL CALCS
	CALL OUTPUT
	CALL READ

2100-MAJOR-MODULE
	CALL MAJOR-BREAK
	CALL BOAT-SWITCH
	CALL MAJOR-TITLE-LINE

2200-CALCS
	CALL ACCESSORY-SWITCH
	C-TOTAL-COST = I-BOAT-COST + I-PREP-DELIVER-COST
	M-NUM-SOLD ++
	M-BOAT-COST += C-TOTAL-COST

2210-ACCESSORY-SWITCH
	SELECT(I-ACCESSORY-PACKAGE)
		CASE: 1
			O-ACCESSORY-PACKAGE = "ELECTRONICS"
			BREAK
		CASE: 2
			O-ACCESSORY-PACKAGE = "SKI PACKAGE"
			BREAK
		CASE: 3
			O-ACCESSORY-PACKAGE = "FISHING PACKAGE"
			BREAK
	END-SELECT

2300-OUTPUT
	O-LAST-NAME = FORMAT(I-LAST-NAME)
	O-STATE = FORMAT(I-STATE)
	O-BOAT-COST = FORMAT(I-BOAT-COST)
	O-PURCHASE-DATE = FORMAT(I-PURCHASE-DATE)
	O-ACCESSORY-PACKAGE = FORMAT(C-ACCESSORY-PACKAGE)
	O-PREP-DELIVER-COST = FORMAT(I-PREP-DELIVER-COST)
	O-TOTAL-COST = FORMAT(C-TOTAL-COST)
	PRINT DETAIL LINE
	IF EOP
		CALL HEADINGS
	END-IF

3000-CLOSING
	CALL MAJOR-BREAK
	CALL GRAND-TOTALS

3100-GRAND-TOTALS
	O-GT-NUM-SOLD = FORMAT(GT-NUM-SOLD)
	O-GT-TOTAL-COST = FORMAT(GT-TOTAL-COST)

9000-READ
	READ RECORD: I-REC, I-LAST-NAME, I-STATE, I-BOAT-COST, I-PURCHASE-DATE, I-BOAT-TYPE,
		I-ACCESSORY-PACKAGE, I-PREP-DELIVER-COST
	IF NO MORE RECORDS
		EOF = 'TRUE'

9100-BOAT-SWITCH
	SELECT(I-BOAT-TYPE)
		CASE: 'B'
			O-BOAT-TYPE = "BASS BOAT"
			BREAK
		CASE: 'P'
			O-BOAT-TYPE = "PONTOON"
			BREAK
		CASE: 'S'
			O-BOAT-TYPE = "SKI BOAT"
			BREAK
		CASE: 'J'
			O-BOAT-TYPE = "JOHN BOAT"
			BREAK
		CASE: 'C'
			O-BOAT-TYPE = "CANOE"
			BREAK
		CASE: 'R'
			O-BOAT-TYPE = "CABIN CRUISER"
			BREAK
	END-SELECT

9200-HEADINGS
	PCTR ++
	O-PCTR = FORMAT(PCTR)
	PRINT COMPANY LINE: O-SYSDATE, O-PCTR
	PRINT BLANK LINE
	PRINT COLUMN HEADING LINE 1
	PRINT COLUMN HEADING LINE 2
	CALL MAJOR-TITLE-LINE	

9300-MAJOR-TITLE-LINE
	PRINT BLANK LINE
	PRINT MAJOR HEADING: O-BOAT-TYPE
	PRINT BLANK LINE

9400-MAJOR-BREAK
	O-M-NUM-SOLD = FORMAT(M-NUM-SOLD)
	O-M-TOTAL-COST = FORMAT(M-TOTAL-COST)
	PRINT BLANK LINE
	PRINT MAJOR-BREAK-LINE: O-M-NUM-SOLD, O-M-TOTAL-COST


















		