//INPUT VARIABLES
STRING I-REC, I-LAST-NAME, I-STATE, I-BOAT-TYPE
INTEGER I-PURCHASE-DATE, I-ACCESSORY-PACKAGE
DOUBLE I-BOAT-COST, I-PREP-DELIVER-COST

//CALC VARIABLES
STRING O-BOAT-TYPE, O-ACCESSORY-PACKAGE, EOF = 'FALSE'
INTEGER PCTR = 0
DOUBLE C-TOTAL-COST, C-ACCES-COST, C-NEW-BOAT-COST

//MINOR VARIABLES
STRING H-STATE, O-H-STATE, O-MIN-TOTAL-COST, O-MIN-BOAT-CTR
INTEGER MIN-BOAT-CTR = 0
DOUBLE MIN-TOTAL-COST= 0

//MAJOR VARIABLES
STRING H-BOAT-TYPE-CHAR, O-MAJ-TOTAL-COST, O-MAJ-BOAT-CTR,
INTEGER MAJ-BOAT-CTR = 0,
DOUBLE MAJ-TOTAL-COST= 0

//GT VARIABLES
sTRING O-GT-TOTAL-COST, O-GT-BOAT-CTR
INTEGER GT-BOAT-CTR = 0
DOUBLE GT-TOTAL-COST= 0

//DETAIL VARIABLES
STRING O-LAST-NAME, O-STATE, O-BOAT-COST, O-PURCHASE-DATE, O-ACCESSORY-PACKAGE,
	O-PREP-DELIVER-COST, O-TOTAL-COST, O-BOAT-TYPE, O-SYSDATE, O-PCTR, 

0000-MAIN
	1000-INIT
	WHILE EOF == 'FALSE'
		CALL 2000-MAINLINE
	END-WHILE
	3000-CLOSING

1000-INIT
	OPEN INPUT FILE
	OPEN OUTPUT FILE
	O-SYSDATE = FORMAT(SYSDATE)
	CALL 9000-READ
	H-BOAT-TYPE-CHAR = I-BOAT-TYPE
	H-STATE = I-STATE
	CALL 9400-HEADINGS

2000-MAINLINE
	IF H-BOAT-TYPE-CHAR != I-BOAT-TYPE
		CALL 9300-MINOR-BREAK
		CALL 9500-MAJOR-BREAK
		CALL 9100-MAJOR-TITLE-LINE
	ELSE
		IF H-STATE != I-STATE
			CALL 9300-MINOR BREAK
	END-IF
	CALL 2100-CALCS
	CALL 2200-OUTPUT
	CALL 9000-READ

2100-CALCS
	SELECT(I-ACCESSORY-PACKAGE)
		CASE: 1
			O-ACCESSORY-PACKAGE = "ELECTRONICS"
			C-ACCES-COST = 5415.30
			BREAK
		CASE: 2
			O-ACCESSORY-PACKAGE = "SKI PACKAGE"
			C-ACCES-COST = 3980.00
			BREAK
		CASE: 3
			O-ACCESSORY-PACKAGE = "FISHING PACKAGE"
			C-ACCES-COST = 345.45
			BREAK
	END-SELECT
	CALL-9200-BOAT-SWITCH
	C-TOTAL-COST = C-NEW-BOAT-COST + I-PREP-DELIVER-COST + C-ACCES-COST
	MIN-BOAT-CTR ++
	MIN-TOTAL-COST += C-TOTAL-COST

2200-OUTPUT
	O-LAST-NAME = FORMAT(I-LAST-NAME)
	O-STATE = FORMAT(I-STATE)
	O-BOAT-COST = FORMAT(I-BOAT-COST)
	O-PURCHASE-DATE = FORMAT(I-PURCHASE-DATE)
	O-PREP-DELIVER-COST = FORMAT(I-PREP-DELIVER-COST)
	O-TOTAL-COST = FORMAT(C-TOTAL-COST * 1.06)
	PRINT DETAIL LINE: O-LAST-NAME, O-STATE, O-BOAT-COST, O-PURCHASE-DATE, O-PREP-DELIVER-COST, O-TOTAL-COST
	IF EOP
		CALL 9400-HEADINGS
	END-IF

3000-CLOSING
	CALL 9300-MINOR-BREAK
	CALL 9500-MAJOR-BREAK
	CALL 3100-GRAND-TOTALS
	CLOSE INPUT FILE
	CLOSE OUTPUT FILE

3100-GRAND-TOTALS
	O-GT-BOAT-CTR = FORMAT(GT-BOAT-CTR)
	O-GT-TOTAL-COST = FORMAT(GT-TOTAL-COST)
	PRINT BLANK LINE
	PRINT GRAND TOTALS LINE: O-GT-BOAT-CTR, O-GT-TOTAL-COST

9000-READ
	READ RECORD: I-REC, I-LAST-NAME, I-STATE, I-BOAT-COST, I-PURCHASE-DATE, I-BOAT-TYPE,
		I-ACCESSORY-PACKAGE, I-PREP-DELIVER-COST
	IF NO MORE RECORDS
		EOF = 'TRUE'

9100-MAJOR-TITLE-LINE
	9200-BOAT-SWITCH
	PRINT BLANK LINE
	PRINT MAJOR HEADING: O-BOAT-TYPE
	PRINT BLANK LINE

9200-BOAT-SWITCH
		SELECT(I-BOAT-TYPE)
		CASE: 'B'
			O-BOAT-TYPE = "BASS BOAT"
			C-NEW-BOAT-COST = I-BOAT-COST * 1.33
			BREAK
		CASE: 'P'
			O-BOAT-TYPE = "PONTOON"
			C-NEW-BOAT-COST = I-BOAT-COST * 1.25
			BREAK
		CASE: 'S'
			O-BOAT-TYPE = "SKI BOAT"
			C-NEW-BOAT-COST = I-BOAT-COST * 1.425
			BREAK
		CASE: 'J'
			O-BOAT-TYPE = "JOHN BOAT"
			C-NEW-BOAT-COST = I-BOAT-COST * 1.33
			BREAK
		CASE: 'C'
			O-BOAT-TYPE = "CANOE"
			C-NEW-BOAT-COST = I-BOAT-COST * 1.20
			BREAK
		CASE: 'R'
			O-BOAT-TYPE = "CABIN CRUISER"
			C-NEW-BOAT-COST = I-BOAT-COST * 1.30
			BREAK
	END-SELECT

9300-MINOR-BREAK
	O-H-STATE = FORMAT(H-STATE)
	O-MINOR-BOAT-TYPE = FORMAT(O-BOAT-TYPE)
	O-MIN-BOAT-CTR = FORMAT(MIN-BOAT-CTR)
	O-MIN-TOTAL-COST = FORMAT(MIN-TOTAL-COST)
	PRINT BLANK LINE
	PRINT MINOR BREAK LINE:O-H-STATE, O-MINOR-BOAT-TYPE, O-MIN-BOAT-CTR, O-MIN-TOTAL-COST
	PRINT BLANK LINE
	IF( NO MORE LINES)
		CALL 9400-HEADINGS
	MAJ-BOAT-CTR ++
	MAJ-TOTAL-COST += MIN-TOTAL-COST
	MIN-BOAT-CTR = 0
	MIN-TOTAL-COST = 0
	H-STATE = I-STATE

9400-HEADINGS
	PCTR ++
	O-PCTR = FORMAT(PCTR)
	PRINT COMPANY LINE: O-SYSDATE, O-PCTR
	PRINT BLANK LINE
	PRINT COLUMN HEADING LINE 1
	PRINT COLUMN HEADING LINE 2
	CALL 9100-MAJOR-TITLE-LINE	

9500-MAJOR-BREAK
	O-MAJ-BOAT-CTR = FORMAT(MAJ-BOAT-CTR)
	O-MAJ-TOTAL-COST = FORMAT(MMAJ-TOTAL-COST)
	PRINT BLANK LINE
	PRINT MAJOR-BREAK-LINE: O-BOAT-TYPE, O-MAJ-BOAT-CTR, O-M-TOTAL-COST
	GT-BOAT-CTR += MAJ-BOAT-CTR
	GT-TOTAL-COST += M-TOTAL-COST
	MAJ-BOAT-CTR = 0
	M-TOTAL-COST = 0
	H-BOAT-TYPE-CHAR = I-BOAT-TYPE